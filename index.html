<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SealTech System: The Future of Preservation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase Imports for Authentication (Required for Canvas Environment) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // Global variables provided by the Canvas environment
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        if (Object.keys(firebaseConfig).length > 0) {
            const app = initializeApp(firebaseConfig);
            window.auth = getAuth(app);
            
            // Authenticate user using custom token or anonymously
            (async () => {
                try {
                    if (initialAuthToken) {
                        await signInWithCustomToken(window.auth, initialAuthToken);
                    } else {
                        await signInAnonymously(window.auth);
                    }
                    console.log("Firebase Auth initialized successfully.");
                    // After successful auth, enable the chat input and button
                    document.getElementById('chat-input').disabled = false;
                    document.getElementById('send-btn').disabled = false;
                } catch (error) {
                    console.error("Firebase Auth error:", error);
                }
            })();
        } else {
            console.warn("Firebase configuration is missing. Chatbot functionality may be limited.");
            // Still enable chat for local testing, assuming external API access works
            document.getElementById('chat-input').disabled = false;
            document.getElementById('send-btn').disabled = false;
        }
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        /* Custom scrollbar for chat box */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #94a3b8; /* slate-400 */
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background-color: #e2e8f0; /* slate-200 */
        }
        /* Air particle animation for the simulation */
        @keyframes subtle-move {
            0% { transform: translate(0, 0); }
            50% { transform: translate(1px, 2px); }
            100% { transform: translate(0, 0); }
        }
        .air-particle {
            animation: subtle-move 4s infinite alternate ease-in-out;
            opacity: 0.7;
        }
        /* Loading animation for chatbot */
        @keyframes typing {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }
        .dot {
            animation: typing 1s infinite;
        }
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }
    </style>
</head>
<body class="text-slate-700">

    <header class="bg-white/80 backdrop-blur-lg fixed top-0 left-0 right-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- This inner div uses Flexbox to position items (Logo on left, Nav on right) -->
            <div class="flex justify-between items-center h-20">
                
                <!-- Logo and Branding -->
                <a href="/" class="flex items-center space-x-3 text-3xl font-extrabold text-sky-700 transition duration-150 ease-in-out hover:text-sky-900">
                    <img 
                        class="h-8 w-8 rounded-xl shadow-lg border-2 border-sky-200" 
                        src="file:///C:/Users/mrray/Downloads/S.png"
                        onerror="this.onerror=null; this.src='https://placehold.co/40x40/64748b/ffffff?text=ST';"
                        alt="SealTech Logo"
                    >
                    <span class="text-2xl font-bold text-sky-600">SealTech</span>
                </a>

                <!-- Navigation Links are kept on the right side -->
                <nav class="hidden md:flex space-x-8 text-gray-700 font-semibold">
                    <a href="#how-it-works" class="hover:text-sky-600 transition duration-150 py-2">The Science</a>
                    <a href="#components" class="hover:text-sky-600 transition duration-150 py-2">Components</a>
                    <a href="#usage" class="hover:text-sky-600 transition duration-150 py-2">How to Use</a>
                    <a href="#benefits" class="hover:text-sky-600 transition duration-150 py-2">Benefits</a>
                    <a href="#chatbot-qa" class="hover:text-sky-600 transition duration-150 py-2">Q&A</a>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="pt-24 pb-16 md:pt-32 md:pb-24 bg-white">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-5xl sm:text-6xl lg:text-7xl font-extrabold tracking-tighter text-slate-800">Preserve More. <span class="text-sky-600">Store Smarter.</span></h1>
                <p class="mt-4 md:mt-6 text-lg md:text-xl text-slate-600">The SealTech System provides durable, long-term vacuum sealing for everything, from seasonal clothing to large food batches, making preservation simple and effective!</p>
                <a href="#how-it-works" class="mt-8 inline-block bg-sky-600 text-white font-semibold px-8 py-3 rounded-lg shadow-lg hover:bg-sky-700 transition-all transform hover:scale-105">Discover How It Works</a>
            </div>
        </section>

        <!-- How It Works Section (Boyle's Law Simulation) -->
        <section id="how-it-works" class="py-20 bg-slate-50">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">The Science of Preservation: Boyle's Law</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-slate-600">The SealTech System's effectiveness is rooted in science. By removing air from the specialized SealBag, **internal pressure is reduced dramatically (Volume decreases)**. The constant atmospheric pressure outside then compresses the bag, creating a compact, oxygen-deprived area perfect for preservation. Watch the simulation below!</p>
                </div>

                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="bg-white p-6 rounded-xl shadow-2xl border border-sky-200">
                        <h3 class="text-xl font-semibold mb-4 text-center text-slate-700">Interactive Seal & Compress Demo</h3>
                        <div class="flex justify-center items-center h-48 mb-6">
                            <!-- Visual representation of the bag and contents -->
                            <div id="seal-bag-visual" class="relative bg-sky-100/70 border-2 border-dashed border-sky-400 rounded-xl transition-all duration-1000 ease-in-out shadow-inner" style="width: 280px; height: 180px;">
                                
                                <!-- Internal Contents (the item being compressed) -->
                                <div class="absolute inset-0 flex items-center justify-center" id="bag-contents">
                                    <div id="item-content" class="w-3/4 h-3/4 bg-red-500 rounded-lg shadow-xl transition-all duration-1000 ease-in-out flex items-center justify-center text-sm font-bold text-white opacity-80" style="background-color: #fb7185;">
                                        Item (e.g., Blanket)
                                    </div>
                                </div>
                                
                                <!-- Air particles will be generated by JS -->
                                <div class="absolute inset-0 flex flex-wrap items-center justify-center p-2 gap-2 transition-opacity duration-1000" id="air-particles">
                                </div>

                                <span class="absolute -top-3 -right-3 bg-white px-2 py-1 rounded-full text-xs font-bold text-slate-600 shadow-lg border border-slate-200">VALVE</span>
                            </div>
                        </div>
                        <div class="text-center space-x-4">
                            <button id="activate-pump-btn" class="bg-sky-600 text-white font-semibold px-6 py-2 rounded-lg shadow-md hover:bg-sky-700 transition-colors transform hover:scale-105">Activate SealPump</button>
                            <button id="reset-btn" class="hidden bg-slate-300 text-slate-700 font-semibold px-6 py-2 rounded-lg shadow-md hover:bg-slate-400 transition-colors transform hover:scale-105">Reset Simulation</button>
                        </div>
                    </div>
                    <div>
                        <div class="chart-container bg-white p-4 rounded-xl shadow-2xl border border-sky-200">
                             <canvas id="boylesLawChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Core Components Section -->
        <section id="components" class="py-20 bg-white">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Engineered for Performance</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-slate-600">Every part of the SealTech System, from the multi-layer bag to the powerful pump, is designed for durability, reusability, and a seamless experience. Explore the components.</p>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-slate-50 p-8 rounded-xl shadow-lg border border-slate-200">
                           <h3 class="text-2xl font-bold mb-4 text-slate-800">The SealBag</h3>
                           <ul class="space-y-3">
                            <li class="flex items-start">
                                <span class="text-sky-600 font-bold mr-3 mt-1">&#10003;</span>
                                <span><strong class="font-semibold">Heavy-Duty Material:</strong> A multi-layer polymer blend prevents tears and ensures long-term air tightness.</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-600 font-bold mr-3 mt-1">&#10003;</span>
                                <span><strong class="font-semibold">Proprietary Sealing Track:</strong> An extra-wide, double-track zipper creates a high-pressure, airtight seal.</span>
                            </li>
                             <li class="flex items-start">
                                <span class="text-sky-600 font-bold mr-3 mt-1">&#10003;</span>
                                <span><strong class="font-semibold">High-Flow Valve:</strong> The reinforced one-way valve allows for rapid air extraction and prevents any leakage over time.</span>
                            </li>
                           </ul>
                    </div>
                     <div class="bg-slate-50 p-8 rounded-xl shadow-lg border border-slate-200">
                           <h3 class="text-2xl font-bold mb-4 text-slate-800">The SealPump</h3>
                           <p class="mb-4">A powerful, rechargeable pump with intelligent modes for every need.</p>
                           <div class="flex space-x-2 mb-4 border-b border-slate-300">
                               <button data-mode="quick" class="mode-btn flex-1 p-3 font-semibold border-b-2 border-sky-600 text-sky-600 bg-sky-50 rounded-t-lg">Quick-Seal</button>
                               <button data-mode="deep" class="mode-btn flex-1 p-3 font-semibold border-b-2 border-transparent text-slate-500 hover:text-slate-700">Deep-Seal</button>
                           </div>
                           <div id="mode-description">
                               <h4 class="font-semibold text-lg mb-2">Maximum Compaction</h4>
                               <p>The high-speed, high-flow mode is perfect for rapidly reducing the bulk of soft items like clothes, bedding, and pillows, in seconds.</p>
                           </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- How to Use Section -->
        <section id="usage" class="py-20">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Simple 5-Step Process</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-slate-600">We designed the SealTech System to be incredibly intuitive. From loading your items to storing them away, the process is quick, easy, and satisfying. Follow these simple steps to get started.</p>
                </div>
                <div class="grid sm:grid-cols-2 lg:grid-cols-5 gap-6 text-center">
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-sky-100 hover:shadow-xl transition">
                        <div class="text-3xl font-bold text-sky-600 mb-2">1</div>
                        <h4 class="font-semibold text-lg mb-2">Load</h4>
                        <p class="text-sm">Place your item(s) into the SealBag and lay it flat on a surface.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-sky-100 hover:shadow-xl transition">
                        <div class="text-3xl font-bold text-sky-600 mb-2">2</div>
                        <h4 class="font-semibold text-lg mb-2">Seal</h4>
                        <p class="text-sm">Firmly slide the zipper across the Sealing Track to close the bag.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-sky-100 hover:shadow-xl transition">
                        <div class="text-3xl font-bold text-sky-600 mb-2">3</div>
                        <h4 class="font-semibold text-lg mb-2">Vacuum</h4>
                        <p class="text-sm">Attach the SealPump to the valve and select your desired mode.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-sky-100 hover:shadow-xl transition">
                         <div class="text-3xl font-bold text-sky-600 mb-2">4</div>
                        <h4 class="font-semibold text-lg mb-2">Compress</h4>
                        <p class="text-sm">Watch as the bag compresses. The pump shuts off automatically.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-sky-100 hover:shadow-xl transition">
                         <div class="text-3xl font-bold text-sky-600 mb-2">5</div>
                        <h4 class="font-semibold text-lg mb-2">Store</h4>
                        <p class="text-sm">Remove the pump and store your now-compact and protected item.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Benefits Section -->
        <section id="benefits" class="py-20 bg-white">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                 <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Designed for Your Life</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-slate-600">The SealTech system isn't just a product; it's a better way to manage your space and preserve your valuables. </p>
                </div>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="text-center bg-slate-50 p-6 rounded-xl shadow">
                        <div class="text-4xl mb-3">🛡️</div>
                        <h4 class="text-xl font-semibold mb-2">Extreme Durability</h4>
                        <p>The SealBag is designed for heavy contents and many uses without rupturing under pressure.</p>
                    </div>
                     <div class="text-center bg-slate-50 p-6 rounded-xl shadow">
                        <div class="text-4xl mb-3">💡</div>
                        <h4 class="text-xl font-semibold mb-2">Intuitive Feedback</h4>
                        <p>The SealPump’s display offers simple indicators, making it highly user-friendly.</p>
                    </div>
                     <div class="text-center bg-slate-50 p-6 rounded-xl shadow">
                        <div class="text-4xl mb-3">🤲</div>
                        <h4 class="text-xl font-semibold mb-2">Accessible Design</h4>
                        <p>The easy-glide Sealing Track is designed to require less force than traditional mechanisms.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Product Q&A Chatbot Section -->
        <section id="chatbot-qa" class="py-20 bg-slate-100">
            <div class="max-w-xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">TechSeal Bot: Your Product Expert</h2>
                    <p class="mt-4 text-lg text-slate-600">Ask us anything about the SealTech System, vacuum sealing, or material science.</p>
                </div>
                <!-- Chat Interface -->
                <div id="chat-container" class="bg-white p-6 rounded-xl shadow-2xl flex flex-col h-[500px] border border-sky-200">
                    <div id="chat-messages" class="flex-grow overflow-y-auto space-y-4 mb-4 p-2 custom-scrollbar">
                        <!-- Initial Bot Message -->
                        <div class="flex justify-start">
                            <div class="bg-sky-500 text-white p-3 rounded-tr-xl rounded-bl-xl rounded-br-xl max-w-[80%] shadow-md whitespace-pre-wrap">
                                Hello! I'm TechSeal Bot. I'm here to answer your questions about the SealTech System's features, science, and durability. How can I assist you today?
                            </div>
                        </div>
                    </div>
                    <form id="chat-form" class="flex space-x-3">
                        <input type="text" id="chat-input" placeholder="Ask a question..." required disabled
                            class="flex-grow p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 transition-shadow disabled:bg-slate-50">
                        <button type="submit" id="send-btn"
                            class="bg-sky-600 text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:bg-sky-700 transition-colors disabled:opacity-50"
                            disabled>
                            Send
                        </button>
                    </form>
                    <div id="status-message" class="mt-2 text-left text-sm text-slate-500 hidden">
                        <div class="flex items-center">
                            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-sky-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span class="text-sky-500">TechSeal Bot is thinking...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <footer class="bg-slate-800 text-slate-300 py-8">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2025 SealTech Systems. All rights reserved. Made by Rayaan Basit, Muhammad Kamran, and Ali Salam. </p>
            <p class="text-sm text-slate-400 mt-2">Revolutionizing storage and preservation through science.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // === Chatbot API Configuration ===
        const GEMINI_API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=";
        const API_KEY = ""; // Canvas will provide the key at runtime

        const systemPrompt = "You are the SealTech Bot, a highly knowledgeable and friendly product expert for the SealTech System. Your goal is to answer user questions regarding the product's features, the science behind vacuum sealing (Boyle's Law), material durability, and usage instructions. Be concise, helpful, and maintain a professional tone, always encouraging long-term preservation and efficient storage. You also say things like "Aargh" and "Yeehaw" after answering each.;

        // Helper function to append a message to the chat interface
        function appendMessage(sender, text) {
            const messagesContainer = document.getElementById('chat-messages');
            const isUser = sender === 'user';
            
            const messageWrapper = document.createElement('div');
            messageWrapper.className = `flex ${isUser ? 'justify-end' : 'justify-start'}`;

            const messageBubble = document.createElement('div');
            messageBubble.className = `p-3 max-w-[80%] shadow-md whitespace-pre-wrap ${
                isUser 
                ? 'bg-sky-100 text-slate-800 rounded-tl-xl rounded-bl-xl rounded-br-xl' 
                : 'bg-sky-500 text-white rounded-tr-xl rounded-bl-xl rounded-br-xl'
            }`;
            messageBubble.innerHTML = text;
            
            messageWrapper.appendChild(messageBubble);
            messagesContainer.appendChild(messageWrapper);
            
            // Auto-scroll to the bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Main function to call the Gemini API
        async function fetchGeminiResponse(userQuery) {
            const statusMessage = document.getElementById('status-message');
            statusMessage.classList.remove('hidden');

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                // Use Google Search for grounded responses
                tools: [{ "google_search": {} }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            const apiUrl = `${GEMINI_API_URL}${API_KEY}`;
            let responseText = "Sorry, I encountered an issue connecting to my knowledge base. Please try again.";

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    responseText = candidate.content.parts[0].text;
                }

            } catch (error) {
                console.error("Gemini API Error:", error);
                // Keep the default error message
            } finally {
                statusMessage.classList.add('hidden');
            }
            return responseText;
        }


        // === Main App Object ===
        document.addEventListener('DOMContentLoaded', () => {
            const app = {
                // Chart variables
                chart: null,
                chartData: {
                    initial: [100, 20], // Initial Volume (100%), Effective Pressure (20%)
                    final: [30, 90]    // Final Volume (30%), Effective Pressure (90%)
                },
                
                // DOM Elements
                elements: {
                    activateBtn: document.getElementById('activate-pump-btn'),
                    resetBtn: document.getElementById('reset-btn'),
                    sealBagVisual: document.getElementById('seal-bag-visual'),
                    airParticlesContainer: document.getElementById('air-particles'),
                    itemContent: document.getElementById('item-content'),
                    modeButtons: document.querySelectorAll('.mode-btn'),
                    modeDescription: document.getElementById('mode-description'),
                    navLinks: document.querySelectorAll('header nav a'),
                    chatForm: document.getElementById('chat-form'),
                    chatInput: document.getElementById('chat-input'),
                    sendBtn: document.getElementById('send-btn'),
                },

                init() {
                    this.setupChart();
                    this.generateAirParticles();
                    this.addEventListeners();
                    // Initial state for chat input is handled by the script module block above after Firebase init
                },

                setupChart() {
                    const ctx = document.getElementById('boylesLawChart').getContext('2d');
                    this.chart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Volume (%)', 'Effective Pressure (%)'],
                            datasets: [{
                                label: 'State',
                                data: this.chartData.initial,
                                backgroundColor: ['rgba(56, 189, 248, 0.7)', 'rgba(100, 116, 139, 0.7)'],
                                borderColor: ['rgba(56, 189, 248, 1)', 'rgba(100, 116, 139, 1)'],
                                borderWidth: 1,
                                borderRadius: 5,
                            }]
                        },
                        options: {
                            maintainAspectRatio: false,
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: {
                                        callback: function(value) {
                                            return value + '%'
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                title: {
                                    display: true,
                                    text: 'Volume vs. Effective Pressure Relationship (Initial State)',
                                    font: { size: 16, weight: 'bold' },
                                    color: '#1e293b'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.label + ': ' + context.parsed.y + '%';
                                        }
                                    }
                                }
                            }
                        }
                    });
                },

                generateAirParticles(count = 20) {
                    this.elements.airParticlesContainer.innerHTML = '';
                    for (let i = 0; i < count; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'w-1.5 h-1.5 bg-sky-500 rounded-full air-particle';
                        // Add random position offset for the animation start
                        particle.style.animationDelay = `${-i * 0.2}s`;
                        this.elements.airParticlesContainer.appendChild(particle);
                    }
                },

                addEventListeners() {
                    this.elements.activateBtn.addEventListener('click', () => this.runAnimation());
                    this.elements.resetBtn.addEventListener('click', () => this.resetAnimation());
                    
                    this.elements.modeButtons.forEach(button => {
                        button.addEventListener('click', (e) => this.handleModeChange(e));
                    });

                    this.elements.navLinks.forEach(anchor => {
                        anchor.addEventListener('click', function (e) {
                            e.preventDefault();
                            document.querySelector(this.getAttribute('href')).scrollIntoView({
                                behavior: 'smooth'
                            });
                        });
                    });

                    // Chatbot form handler
                    this.elements.chatForm.addEventListener('submit', (e) => this.handleChatSubmit(e));
                },
                
                runAnimation() {
                    this.elements.activateBtn.classList.add('hidden');
                    this.elements.resetBtn.classList.remove('hidden');

                    // Animate bag (shrink)
                    this.elements.sealBagVisual.style.width = '120px';
                    this.elements.sealBagVisual.style.height = '80px';

                    // Animate item (compress)
                    this.elements.itemContent.style.width = '70%'; // Item compresses to 70% of the new bag width
                    this.elements.itemContent.style.height = '70%'; // Item compresses to 70% of the new bag height
                    this.elements.itemContent.style.opacity = '1';

                    // Remove air particles visually
                    this.elements.airParticlesContainer.style.opacity = '0';
                    this.elements.airParticlesContainer.style.gap = '0'; 

                    // Animate chart
                    this.chart.data.datasets[0].data = this.chartData.final;
                    this.chart.options.plugins.title.text = 'Low Volume, High Effective Pressure (Final State)';
                    this.chart.data.datasets[0].backgroundColor = ['rgba(239, 68, 68, 0.7)', 'rgba(20, 184, 166, 0.7)']; // Optional color change for "final"
                    this.chart.update();
                },

                resetAnimation() {
                    this.elements.activateBtn.classList.remove('hidden');
                    this.elements.resetBtn.classList.add('hidden');
                    
                    // Reset bag
                    this.elements.sealBagVisual.style.width = '280px';
                    this.elements.sealBagVisual.style.height = '180px';

                    // Reset item
                    this.elements.itemContent.style.width = '75%';
                    this.elements.itemContent.style.height = '75%';
                    this.elements.itemContent.style.opacity = '0.8';

                    // Reset air particles
                    this.elements.airParticlesContainer.style.opacity = '1';
                    this.elements.airParticlesContainer.style.gap = '8px';

                    // Reset chart
                    this.chart.data.datasets[0].data = this.chartData.initial;
                    this.chart.options.plugins.title.text = 'Volume vs. Effective Pressure Relationship (Initial State)';
                    this.chart.data.datasets[0].backgroundColor = ['rgba(56, 189, 248, 0.7)', 'rgba(100, 116, 139, 0.7)'];
                    this.chart.update();
                },

                handleModeChange(e) {
                    const selectedMode = e.currentTarget.dataset.mode;
                    
                    this.elements.modeButtons.forEach(btn => {
                        btn.classList.remove('border-sky-600', 'text-sky-600', 'bg-sky-50');
                        btn.classList.add('border-transparent', 'text-slate-500');
                    });
                    
                    e.currentTarget.classList.add('border-sky-600', 'text-sky-600', 'bg-sky-50');
                    e.currentTarget.classList.remove('border-transparent', 'text-slate-500');

                    const descriptions = {
                        quick: {
                            title: 'Maximum Compaction',
                            text: 'The high-speed, high-flow mode is perfect for rapidly reducing the bulk of soft items, maximizing storage space in seconds.'
                        },
                        deep: {
                            title: 'Long-Term Preservation',
                            text: 'This lower-flow mode achieves a nearly maxed vacuum, removing more oxygen to inhibit oxidation. It is ideal for long-term food preservation or protection of delicate documents.'
                        }
                    };
                    
                    this.elements.modeDescription.innerHTML = `
                        <h4 class="font-semibold text-lg mb-2">${descriptions[selectedMode].title}</h4>
                        <p>${descriptions[selectedMode].text}</p>
                    `;
                },

                async handleChatSubmit(e) {
                    e.preventDefault();
                    const query = this.elements.chatInput.value.trim();
                    if (!query) return;

                    // 1. Display user message
                    appendMessage('user', query);
                    
                    // 2. Clear input and disable
                    this.elements.chatInput.value = '';
                    this.elements.chatInput.disabled = true;
                    this.elements.sendBtn.disabled = true;

                    // 3. Get bot response
                    const botResponse = await fetchGeminiResponse(query);

                    // 4. Display bot message
                    appendMessage('bot', botResponse);

                    // 5. Re-enable input
                    this.elements.chatInput.disabled = false;
                    this.elements.sendBtn.disabled = false;
                    this.elements.chatInput.focus();
                }
            };
            
            app.init();
        });
    </script>
</body>
</html>

